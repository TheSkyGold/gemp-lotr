<%@ page contentType="text/html; charset=UTF-8"%>
<%
response.setHeader("Cache-Control","no-cache");
response.setHeader("Pragma","no-cache");
response.setDateHeader ("Expires", -1);
%>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title>Gemp-LotR</title>

    <style type="text/css">
        body {
            font-size: 12px;
        }

        .ui-button-text-only .ui-button-text {
            font-size: 70%;
            padding: .2em .5em;
        }
    </style>

    <%@ include file="js.inc" %>
    
    <script type="text/javascript">
        jQuery.fn.center = function () {
            this.css("position", "absolute");
            this.css("top", (($(window).height() - this.outerHeight()) / 2) + $(window).scrollTop() + "px");
            this.css("left", (($(window).width() - this.outerWidth()) / 2) + $(window).scrollLeft() + "px");
            return this;
        };

        var comm = new GempLotrCommunication("/gemp-lotr-server", function () {
            alert("Unable to contact the server");
        });

        function processResponse(html) {
            $("#message").append(html).center();
            attachEvents();
        }

        $(document).ready(
                function () {
                    comm.getStatus(processResponse);
                });

        function attachEvents() {
            var loginButton = $("#loginButton");
            if (loginButton != null) {
                loginButton.button().click(
                        function () {
                            var login = $("#login").val();
                            var password = $("#password").val();
                            $("#message").html("");
                            comm.login(login, password, processResponse);
                        });
            }

            var registerButton = $("#registerButton");
            if (registerButton != null) {
                registerButton.button().click(
                        function () {
                            var login = $("#login").val();
                            var password = $("#password").val();
                            var password2 = $("#password2").val();
                            if (password != password2) {
                                alert("Password and Password repeated are different!");
                            } else {
                                $("#message").html("");
                                comm.register(login, password, processResponse);
                            }
                        });
            }

            var clickToRegisterButton = $("#clickToRegister");
            if (clickToRegisterButton != null) {
                clickToRegisterButton.button().click(
                        function () {
                            $("#message").html("");
                            comm.getRegistrationForm(processResponse);
                        });
            }
        }
    </script>

</head>
<body bgcolor="#000000">
<div style="float: left;height: 98%"><img src="images/troll.png" height="98%"/></div>
<div style="float: right;height: 98%"><img src="images/man.png" height="98%"/></div>
<div id="message" style="color:#ffffff;"></div>
</body>
</html>
